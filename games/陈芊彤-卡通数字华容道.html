<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¡é€šæ•°å­—åå®¹é“</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#4F46E5',
            secondary: '#EC4899',
            accent: '#F59E0B',
            background: '#F8FAFC',
            surface: '#FFFFFF',
            dark: '#1E293B'
          },
          fontFamily: {
            comic: ['"Comic Sans MS"', 'cursive', 'sans-serif'],
          },
        },
      }
    }
  </script>
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .puzzle-grid {
        display: grid;
        grid-template-columns: repeat(var(--grid-cols, 4), 1fr);
        gap: 0.5rem;
      }
      .puzzle-piece {
        transition: all 0.3s ease;
      }
      .puzzle-piece:hover:not(.empty) {
        transform: scale(1.05);
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      }
      .animate-slide {
        animation: slide 0.3s ease-out;
      }
      @keyframes slide {
        from { transform: scale(0.95); opacity: 0.8; }
        to { transform: scale(1); opacity: 1; }
      }
      .celebration {
        animation: celebration 1s ease-in-out;
      }
      @keyframes celebration {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.1); box-shadow: 0 0 20px rgba(245, 158, 11, 0.8); }
      }
    }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen font-comic text-dark">
<!-- è¿”å›ä¸»é¡µæŒ‰é’® -->
<div id="homeNavigation" style="position: fixed; top: 20px; left: 20px; z-index: 9999;">
    <a href="../index.html" 
       style="display: inline-flex; align-items: center; gap: 8px; 
              background: linear-gradient(135deg, #FF6B6B, #4ECDC4); 
              color: white; padding: 12px 20px; border-radius: 25px; 
              text-decoration: none; font-family: 'Microsoft YaHei', sans-serif; 
              font-weight: bold; font-size: 14px; 
              box-shadow: 0 4px 15px rgba(0,0,0,0.2); 
              transition: all 0.3s ease;
              backdrop-filter: blur(10px);"
       onmouseover="this.style.transform='translateY(-2px) scale(1.05)'; this.style.boxShadow='0 6px 20px rgba(0,0,0,0.3)';"
       onmouseout="this.style.transform='translateY(0) scale(1)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.2)';">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
        </svg>
        è¿”å›æ˜Ÿçƒå·¥åŠ
    </a>
</div>

  <div class="container mx-auto px-4 py-8 max-w-4xl">
    <!-- æ¸¸æˆæ ‡é¢˜ -->
    <header class="text-center mb-8">
      <h1 class="text-[clamp(2rem,5vw,3rem)] font-bold text-transparent bg-clip-text bg-gradient-to-r from-primary to-secondary mb-2">å¡é€šæ•°å­—åå®¹é“</h1>
      <p class="text-gray-600 text-lg">å°†æ•°å­—æŒ‰é¡ºåºæ’åˆ—ï¼ŒæŒ‘æˆ˜ä½ çš„æ€ç»´èƒ½åŠ›ï¼</p>
    </header>

    <!-- æ¸¸æˆä¿¡æ¯é¢æ¿ -->
    <div class="bg-white rounded-xl shadow-lg p-4 mb-6 flex flex-wrap justify-between items-center">
      <div class="flex items-center space-x-2 mb-2 sm:mb-0">
        <i class="fa fa-clock-o text-red-500 text-xl"></i>
        <span class="text-lg font-semibold">æ—¶é—´: <span id="timer" class="text-red-500">0</span>ç§’</span>
      </div>
      <div class="flex items-center space-x-2 mb-2 sm:mb-0">
        <i class="fa fa-magic text-purple-500 text-xl"></i>
        <span class="text-lg font-semibold">æ­¥æ•°: <span id="moves" class="text-purple-500">0</span></span>
      </div>
      <button id="restart-btn" class="bg-secondary hover:bg-secondary/90 text-white font-medium py-2 px-4 rounded-lg transition-all duration-300 transform hover:scale-105 flex items-center">
        <i class="fa fa-refresh mr-2"></i> é‡æ–°å¼€å§‹
      </button>
    </div>

    <!-- æ¸¸æˆåŒºåŸŸ -->
    <div class="relative bg-white rounded-xl shadow-xl p-4 overflow-hidden">
      <div id="puzzle-board" class="puzzle-grid mx-auto" style="max-width: 500px;"></div>
      
      <!-- æ¸¸æˆæˆåŠŸè¦†ç›–å±‚ -->
      <div id="success-screen" class="absolute inset-0 bg-dark/80 flex-col items-center justify-center z-10 hidden">
        <div class="bg-white p-8 rounded-2xl text-center shadow-2xl max-w-md w-full">
          <h2 class="text-3xl font-bold text-primary mb-2">æ­å–œä½ ï¼</h2>
          <p class="text-gray-700 text-lg mb-4">ä½ æˆåŠŸå®Œæˆäº†æ•°å­—åå®¹é“ï¼</p>
          <div class="flex justify-center space-x-6 mb-6">
            <div>
              <p class="text-gray-500">ç”¨æ—¶</p>
              <p class="text-2xl font-bold text-red-500" id="final-time">0</p>
              <p class="text-sm text-gray-500">ç§’</p>
            </div>
            <div>
              <p class="text-gray-500">æ­¥æ•°</p>
              <p class="text-2xl font-bold text-purple-500" id="final-moves">0</p>
              <p class="text-sm text-gray-500">æ­¥</p>
            </div>
          </div>
          <button id="play-again-btn" class="bg-accent hover:bg-accent/90 text-white font-bold py-3 px-8 rounded-full text-lg transition-all duration-300 transform hover:scale-110">
            å†ç©ä¸€æ¬¡
          </button>
        </div>
      </div>
    </div>

    <!-- æ¸¸æˆè¯´æ˜ -->
    <div class="bg-white rounded-xl shadow-lg p-4 mt-6">
      <h3 class="text-xl font-semibold mb-2 flex items-center">
        <i class="fa fa-info-circle text-primary mr-2"></i> æ¸¸æˆè¯´æ˜
      </h3>
      <ul class="space-y-2 text-gray-700">
        <li class="flex items-start">
          <i class="fa fa-check-circle text-green-500 mt-1 mr-2"></i>
          <span>ç‚¹å‡»ä¸ç©ºç™½æ–¹æ ¼ç›¸é‚»çš„æ•°å­—ï¼Œå°†å…¶ç§»å…¥ç©ºç™½ä½ç½®</span>
        </li>
        <li class="flex items-start">
          <i class="fa fa-check-circle text-green-500 mt-1 mr-2"></i>
          <span>ç›®æ ‡æ˜¯å°†æ‰€æœ‰æ•°å­—æŒ‰é¡ºåºä»å·¦åˆ°å³ã€ä»ä¸Šåˆ°ä¸‹æ’åˆ—</span>
        </li>
        <li class="flex items-start">
          <i class="fa fa-check-circle text-green-500 mt-1 mr-2"></i>
          <span>æŒ‘æˆ˜è‡ªå·±ï¼Œç”¨æœ€å°‘çš„æ­¥æ•°å’Œæœ€çŸ­çš„æ—¶é—´å®Œæˆæ¸¸æˆ</span>
        </li>
      </ul>
    </div>
  </div>

  <script>
    // æ¸¸æˆé…ç½®
    const config = {
      gridSize: 4, // 4x4ç½‘æ ¼
      animationDuration: 300, // åŠ¨ç”»æŒç»­æ—¶é—´(æ¯«ç§’)
    };
    
    // æ¸¸æˆçŠ¶æ€
    let gameState = {
      grid: [],
      emptyPos: { row: config.gridSize - 1, col: config.gridSize - 1 },
      moves: 0,
      time: 0,
      timerInterval: null,
      isPlaying: false,
      isSolving: false,
      colors: [
        '#EF4444', '#10B981', '#3B82F6', '#F59E0B',
        '#8B5CF6', '#EC4899', '#14B8A6', '#6366F1',
        '#F97316', '#A855F7', '#EC4899', '#06B6D4',
        '#FBBF24', '#10B981', '#60A5FA', '#F43F5E'
      ],
      emojis: [
        'ğŸ˜€', 'ğŸ˜ƒ', 'ğŸ˜„', 'ğŸ˜',
        'ğŸ˜†', 'ğŸ˜…', 'ğŸ˜‚', 'ğŸ¤£',
        'ğŸ˜Š', 'ğŸ˜‡', 'ğŸ™‚', 'ğŸ™ƒ',
        'ğŸ˜‰', 'ğŸ˜Œ', 'ğŸ˜', 'ğŸ¥°'
      ]
    };
    
    // DOM å…ƒç´ 
    const puzzleBoard = document.getElementById('puzzle-board');
    const movesDisplay = document.getElementById('moves');
    const timerDisplay = document.getElementById('timer');
    const successScreen = document.getElementById('success-screen');
    const finalTimeDisplay = document.getElementById('final-time');
    const finalMovesDisplay = document.getElementById('final-moves');
    const restartBtn = document.getElementById('restart-btn');
    const playAgainBtn = document.getElementById('play-again-btn');
    
    // åˆå§‹åŒ–æ¸¸æˆ
    function initGame() {
      puzzleBoard.style.setProperty('--grid-cols', config.gridSize);
      resetGame();
      renderGrid();
    }
    
    // é‡ç½®æ¸¸æˆ
    function resetGame() {
      // åœæ­¢è®¡æ—¶å™¨
      if (gameState.timerInterval) {
        clearInterval(gameState.timerInterval);
      }
      
      // ç”Ÿæˆåˆå§‹ç½‘æ ¼
      generateSolvablePuzzle();
      
      // é‡ç½®æ¸¸æˆçŠ¶æ€
      gameState = {
        ...gameState,
        moves: 0,
        time: 0,
        isPlaying: true,
        isSolving: false
      };
      
      // æ›´æ–°æ˜¾ç¤º
      movesDisplay.textContent = gameState.moves;
      timerDisplay.textContent = gameState.time;
      
      // éšè—æˆåŠŸå±å¹•
      successScreen.classList.add('hidden');
      
      // å¼€å§‹è®¡æ—¶
      gameState.timerInterval = setInterval(() => {
        gameState.time++;
        timerDisplay.textContent = gameState.time;
      }, 1000);
    }
    
    // ç”Ÿæˆå¯è§£çš„æ‹¼å›¾
    function generateSolvablePuzzle() {
      // åˆ›å»ºæœ‰åºæ•°ç»„
      const size = config.gridSize * config.gridSize;
      let numbers = Array.from({ length: size - 1 }, (_, i) => i + 1);
      numbers.push(null); // æœ€åä¸€ä¸ªä½ç½®ä¸ºç©º
      
      // éšæœºæ‰“ä¹±æ•°ç»„
      do {
        numbers = shuffleArray(numbers);
      } while (!isSolvable(numbers));
      
      // è½¬æ¢ä¸ºäºŒç»´æ•°ç»„
      gameState.grid = [];
      for (let row = 0; row < config.gridSize; row++) {
        gameState.grid[row] = [];
        for (let col = 0; col < config.gridSize; col++) {
          const index = row * config.gridSize + col;
          gameState.grid[row][col] = numbers[index];
          
          // è®°å½•ç©ºç™½ä½ç½®
          if (numbers[index] === null) {
            gameState.emptyPos = { row, col };
          }
        }
      }
    }
    
    // éšæœºæ‰“ä¹±æ•°ç»„
    function shuffleArray(array) {
      const newArray = [...array];
      for (let i = newArray.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
      }
      return newArray;
    }
    
    // æ£€æŸ¥æ‹¼å›¾æ˜¯å¦å¯è§£
    function isSolvable(numbers) {
      // å¯¹äº4x4çš„åå®¹é“ï¼Œå½“ç©ºç™½åœ¨ç¬¬0æˆ–2è¡Œæ—¶ï¼Œé€†åºæ•°ä¸ºå¶æ•°æ—¶æœ‰è§£
      // å½“ç©ºç™½åœ¨ç¬¬1æˆ–3è¡Œæ—¶ï¼Œé€†åºæ•°ä¸ºå¥‡æ•°æ—¶æœ‰è§£
      
      // è®¡ç®—é€†åºæ•°
      let inversions = 0;
      const size = config.gridSize * config.gridSize;
      
      for (let i = 0; i < size; i++) {
        if (numbers[i] === null) continue;
        
        for (let j = i + 1; j < size; j++) {
          if (numbers[j] === null) continue;
          
          if (numbers[i] > numbers[j]) {
            inversions++;
          }
        }
      }
      
      // è®¡ç®—ç©ºç™½ä½ç½®æ‰€åœ¨è¡Œ
      const emptyIndex = numbers.indexOf(null);
      const emptyRow = Math.floor(emptyIndex / config.gridSize);
      
      // åˆ¤æ–­æ˜¯å¦å¯è§£
      if (config.gridSize % 2 === 1) {
        // å¥‡æ•°è¡Œç½‘æ ¼ï¼šé€†åºæ•°ä¸ºå¶æ•°æ—¶æœ‰è§£
        return inversions % 2 === 0;
      } else {
        // å¶æ•°è¡Œç½‘æ ¼ï¼šç©ºç™½åœ¨å¶æ•°è¡Œä¸”é€†åºæ•°ä¸ºå¶æ•°ï¼Œæˆ–ç©ºç™½åœ¨å¥‡æ•°è¡Œä¸”é€†åºæ•°ä¸ºå¥‡æ•°æ—¶æœ‰è§£
        return (emptyRow % 2 === 0 && inversions % 2 === 0) || (emptyRow % 2 === 1 && inversions % 2 === 1);
      }
    }
    
    // æ¸²æŸ“æ¸¸æˆç½‘æ ¼
    function renderGrid() {
      puzzleBoard.innerHTML = '';
      
      for (let row = 0; row < config.gridSize; row++) {
        for (let col = 0; col < config.gridSize; col++) {
          const value = gameState.grid[row][col];
          
          const cell = document.createElement('div');
          
          if (value === null) {
            // ç©ºç™½å•å…ƒæ ¼
            cell.className = 'aspect-square rounded-lg bg-gray-100';
            cell.dataset.row = row;
            cell.dataset.col = col;
            cell.dataset.empty = 'true';
          } else {
            // æ•°å­—å•å…ƒæ ¼
            const index = value - 1; // å› ä¸ºvalueä»1å¼€å§‹ï¼Œè€Œcolorså’Œemojisä»0å¼€å§‹
            const color = gameState.colors[index % gameState.colors.length];
            const emoji = gameState.emojis[index % gameState.emojis.length];
            
            cell.className = 'aspect-square rounded-lg flex items-center justify-center cursor-pointer transition-all duration-300 puzzle-piece animate-slide';
            cell.style.backgroundColor = color;
            cell.dataset.row = row;
            cell.dataset.col = col;
            
            const numberSpan = document.createElement('div');
            numberSpan.className = 'text-center';
            
            const emojiSpan = document.createElement('div');
            emojiSpan.className = 'text-2xl mb-1';
            emojiSpan.textContent = emoji;
            
            const valueSpan = document.createElement('div');
            valueSpan.className = 'text-xl font-bold text-white';
            valueSpan.textContent = value;
            
            numberSpan.appendChild(emojiSpan);
            numberSpan.appendChild(valueSpan);
            
            cell.appendChild(numberSpan);
            
            // æ·»åŠ ç‚¹å‡»äº‹ä»¶
            cell.addEventListener('click', () => handleCellClick(row, col));
          }
          
          puzzleBoard.appendChild(cell);
        }
      }
    }
    
    // å¤„ç†å•å…ƒæ ¼ç‚¹å‡»
    function handleCellClick(row, col) {
      if (!gameState.isPlaying || gameState.isSolving) return;
      
      // æ£€æŸ¥æ˜¯å¦å¯ä»¥ç§»åŠ¨
      if (canMove(row, col)) {
        // ç§»åŠ¨æ•°å­—
        movePiece(row, col);
        
        // æ£€æŸ¥æ˜¯å¦å®Œæˆ
        if (isGameComplete()) {
          gameComplete();
        }
      }
    }
    
    // æ£€æŸ¥æ˜¯å¦å¯ä»¥ç§»åŠ¨
    function canMove(row, col) {
      const { row: emptyRow, col: emptyCol } = gameState.emptyPos;
      
      // æ£€æŸ¥æ˜¯å¦ç›¸é‚»
      return (
        (Math.abs(row - emptyRow) === 1 && col === emptyCol) ||
        (Math.abs(col - emptyCol) === 1 && row === emptyRow)
      );
    }
    
    // ç§»åŠ¨æ•°å­—
    function movePiece(row, col) {
      const { row: emptyRow, col: emptyCol } = gameState.emptyPos;
      
      // äº¤æ¢æ•°å­—å’Œç©ºç™½ä½ç½®
      gameState.grid[emptyRow][emptyCol] = gameState.grid[row][col];
      gameState.grid[row][col] = null;
      
      // æ›´æ–°ç©ºç™½ä½ç½®
      gameState.emptyPos = { row, col };
      
      // æ›´æ–°æ­¥æ•°
      gameState.moves++;
      movesDisplay.textContent = gameState.moves;
      
      // é‡æ–°æ¸²æŸ“ç½‘æ ¼
      renderGrid();
    }
    
    // æ£€æŸ¥æ¸¸æˆæ˜¯å¦å®Œæˆ
    function isGameComplete() {
      let count = 1;
      const size = config.gridSize * config.gridSize;
      
      for (let row = 0; row < config.gridSize; row++) {
        for (let col = 0; col < config.gridSize; col++) {
          // æœ€åä¸€ä¸ªä½ç½®åº”è¯¥ä¸ºç©º
          if (count === size) {
            return gameState.grid[row][col] === null;
          }
          
          // æ£€æŸ¥æ¯ä¸ªä½ç½®æ˜¯å¦æŒ‰é¡ºåºæ’åˆ—
          if (gameState.grid[row][col] !== count) {
            return false;
          }
          
          count++;
        }
      }
      
      return true;
    }
    
    // æ¸¸æˆå®Œæˆå¤„ç†
    function gameComplete() {
      // åœæ­¢è®¡æ—¶å™¨
      clearInterval(gameState.timerInterval);
      gameState.isPlaying = false;
      
      // æ›´æ–°æˆåŠŸå±å¹•
      finalTimeDisplay.textContent = gameState.time;
      finalMovesDisplay.textContent = gameState.moves;
      
      // æ˜¾ç¤ºæˆåŠŸå±å¹•
      setTimeout(() => {
        successScreen.classList.remove('hidden');
        successScreen.classList.add('flex');
      }, 500);
    }
    
    // äº‹ä»¶ç›‘å¬
    restartBtn.addEventListener('click', resetGame);
    playAgainBtn.addEventListener('click', resetGame);
    
    // åˆå§‹åŒ–æ¸¸æˆ
    initGame();
  </script>

<!-- Author Signature Widget V2 -->
<script id="author-signature-widget-v2">
  (function() {
    function showSignature() {
      var authorNameStr = '*èŠŠå½¤';

      if (document.getElementById('author-signature-container-v2')) {
        return;
      }

      var container = document.createElement('div');
      container.id = 'author-signature-container-v2';
      container.style.position = 'fixed';
      container.style.top = '50%';
      container.style.left = '50%';
      container.style.transform = 'translate(-50%, -50%) scale(0.7)';
      container.style.padding = '30px 50px';
      container.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';
      container.style.color = 'white';
      container.style.borderRadius = '20px';
      container.style.zIndex = '2147483647';
      container.style.fontFamily = '"PingFang SC", "Helvetica Neue", "Microsoft YaHei", sans-serif';
      container.style.fontSize = '10vw';
      container.style.fontWeight = 'bold';
      container.style.textAlign = 'center';
      container.style.boxShadow = '0 10px 30px rgba(0,0,0,0.5)';
      container.style.opacity = '0';
      container.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
      container.style.whiteSpace = 'nowrap';
      container.style.cursor = 'pointer';

      var textElement = document.createElement('span');
      textElement.textContent = 'ä½œè€…: ' + authorNameStr;

      var hideWidget = function() {
        container.style.transform = 'translate(-50%, -50%) scale(0.7)';
        container.style.opacity = '0';
        setTimeout(function() {
          if (container.parentNode) {
            container.parentNode.removeChild(container);
          }
        }, 500);
      };

      container.onclick = hideWidget;

      container.appendChild(textElement);
      document.body.appendChild(container);

      setTimeout(function() {
        container.style.opacity = '1';
        container.style.transform = 'translate(-50%, -50%) scale(1)';
      }, 50);

      setTimeout(hideWidget, 5000);
    }

    if (document.body) {
        showSignature();
    } else {
        document.addEventListener('DOMContentLoaded', showSignature);
    }
  })();
</script>
</body>
</html>    